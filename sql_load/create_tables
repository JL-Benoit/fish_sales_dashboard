-- Create client table with primary key
CREATE TABLE public.client
(
    client_id INT PRIMARY KEY,
    code_magasin VARCHAR(255),
    addresse VARCHAR(255),
    code_postal VARCHAR(255),
    email VARCHAR(255),
    FOREIGN KEY (commercial_id) REFERENCES public.commercial (commercial_id),
    FOREIGN KEY (livraison_id) REFERENCES public.livraison (livraison_id)
);

-- Create commercial table with primary key
CREATE TABLE public.commercial
(
    commercial_id INT PRIMARY KEY,
    prenom VARCHAR (255),
    nom VARCHAR(255),
    FOREIGN KEY (region_id) REFERENCES public.region (region_id)
);

-- Create livraison table with primary key
CREATE TABLE public.livraison
(
    livraison_id INT PRIMARY KEY,
    livraison VARCHAR (25)
);

-- Create region table with primary key
CREATE TABLE public.region
(
    region_id INT PRIMARY KEY,
    region VARCHAR (255)
);

-- Create commande table with primary key
CREATE TABLE public.commande
(
    commande_id INT PRIMARY KEY,
    date_commande DATE,
    FOREIGN KEY (client_id) REFERENCES public.client (client_id),
    FOREIGN KEY (commercial_id) REFERENCES public.commercial (commercial_id),
    FOREIGN KEY (livraison_id) REFERENCES public.livraison (livraison_id)
);

-- Create commande table with primary key
CREATE TABLE public.commande_detail
(
    commande_detail_id INT PRIMARY KEY,
    quantite INT,
    prix_unitaire NUMBER,
    remise NUMBER,
    prix_total NUMBER,
    FOREIGN KEY (commande_id) REFERENCES public.commande (commande_id),
    FOREIGN KEY (produit_id) REFERENCES public.produit (produit_id)
);
















-- Create skills_job_dim table with a composite primary key and foreign keys
CREATE TABLE public.skills_job_dim
(
    job_id INT,
    skill_id INT,
    PRIMARY KEY (job_id, skill_id),
    FOREIGN KEY (job_id) REFERENCES public.job_postings_fact (job_id),
    FOREIGN KEY (skill_id) REFERENCES public.skills_dim (skill_id)
);

-- Set ownership of the tables to the postgres user
ALTER TABLE public.company_dim OWNER to postgres;
ALTER TABLE public.skills_dim OWNER to postgres;
ALTER TABLE public.job_postings_fact OWNER to postgres;
ALTER TABLE public.skills_job_dim OWNER to postgres;

-- Create indexes on foreign key columns for better performance
CREATE INDEX idx_company_id ON public.job_postings_fact (company_id);
CREATE INDEX idx_skill_id ON public.skills_job_dim (skill_id);
CREATE INDEX idx_job_id ON public.skills_job_dim (job_id);