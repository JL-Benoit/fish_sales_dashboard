-- What is the average unit price (prix) of all products currently listed in the inventory?
SELECT 
    ROUND(AVG(prix),2) AS avg_prix
FROM produit;


-- List the prenom and nom of all commercials, and the region name they belong to.
SELECT 
    prenom,
    nom,
    region.region
FROM commercial
LEFT JOIN region ON commercial.region_id = region.region_id


-- Identify the most expensive product (nom_produit) currently offered.
SELECT
    prix,
    nom_produit,
    nom_scientifique
FROM produit
WHERE prix IS NOT NULL
ORDER BY prix DESC
LIMIT 1;


-- Find the total number of distinct regions covered by the sales team.
SELECT
    DISTINCT COUNT(region)
FROM region;


-- How many orders (commande_id) were placed on a specific date (e.g., date_commande = '2023-10-15')?
SELECT 
    COUNT(commande_id)
FROM commande
WHERE date_commande = '2025-09-04';


-- Display the client_id, code_magasin, and associated commercial_id for quick client lookup.
SELECT
    client_id,
    code_magasin,
    client.commercial_id,
    commercial.prenom,
    commercial.nom
FROM client
LEFT JOIN commercial ON client.commercial_id = commercial.commercial_id


-- List all product categories (categorie) to understand the breadth of the offering.
SELECT 
    categorie
FROM categorie;


-- List all product sub-categories (sous_categorie) to understand the breadth of the offering.
SELECT 
    sous_categorie
FROM sous_categorie;

-- Find the total amount of money paid (sum of prix_total) across all orders in the commande_detail table.
SELECT
    SUM(prix_total)
FROM commande_detail;


-- Which livraison (delivery) method is available with livraison_id = 11?
SELECT *
FROM livraison
WHERE livraison_id = 11


-- Retrieve the nom_produit and its scientific name for products belonging to the sub-category with sous_categorie_id 10.
SELECT
    produit.sous_categorie_id,
    sous_categorie,
    nom_produit,
    nom_scientifique,
    prix
FROM produit
LEFT JOIN sous_categorie ON produit.sous_categorie_id = sous_categorie.sous_categorie_id
WHERE produit.sous_categorie_id = 10;



/* Second set of questions:
Part 1: Single Table Queries (SELECT, FROM, WHERE, ORDER BY)
Focus on extracting and filtering data from a single entity table. */

--List the full details (all columns) for all entries in the produit (product) table.
SELECT *
FROM produit;

--Retrieve only the nom and prenom of all sales commercials.
SELECT
    nom,
    prenom
FROM commercial;

--Display the region names and their associated region_id.
SELECT
    region_id,
    region
FROM region;

--Find the code_magasin for all clients listed in the client table.
SELECT
    client_id,
    code_magasin
FROM client;

--List all product names (nom_produit) and their unit prices (prix) from the produit table.
SELECT
    produit_id,
    nom_produit,
    prix
FROM produit;

--Find the details of the product with the produit_id of 'AL1306'.
SELECT *
FROM produit
WHERE produit_id = 'AL1306';

--Display all orders (commande_id) that were placed on the date '2025-11-07'.
SELECT *
FROM commande
WHERE date_commande = '2025-11-07';

--List the client_id and date_commande for all orders placed after the year 2023 (e.g., after '2023-12-31').
SELECT
    client_id,
    date_commande
FROM commande
WHERE date_commande > '2023-12-31';

--Find all commercials whose last name (nom) starts with the letter 'P'.
SELECT *
FROM commercial
WHERE nom LIKE 'P';

--Retrieve the nom_produit and prix of all products that cost less than 50.00, sorted from lowest to highest price.
SELECT
    produit_id,
    nom_produit,
    prix
FROM produit
WHERE prix < 50
ORDER BY prix ASC;